<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.11 (454874)"/><meta name="keywords" content="Computer Security"/><meta name="author" content="josiahbruner"/><meta name="created" content="2017-04-19 21:47:59 +0000"/><meta name="updated" content="2017-04-26 19:03:19 +0000"/><title>Notes on Computer Security</title></head><body><div style="text-align: center;"><font><font style="font-family: 'Helvetica Neue';">Notes by Josiah Bruner (<a href="http://josiahbruner.com">josiahbruner.com</a>)</font></font></div><div style="text-align: center;"><font><font face="Helvetica Neue">Inspired from EECS 388 @ UMich</font></font></div><div><span style="font-size: 24px; font-family: 'Helvetica Neue';">Security Mindset</span></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Level-2 Problem: “Weakness” (Factors that predispose systems to vulnerability)</span></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Level-1 Problem: “Vulnerability” (Specific things that can be exploited to cause an assault</span></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Level-0 Problem: “Assault” (Actual attack on a specific flaw)</span></div><div><br/></div><div><span style="font-size: 24px; font-family: 'Helvetica Neue';">Cryptography</span></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Goals:</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Message Integrity (Attacker can’t modify messages without that being detected)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Want a kind of “hash”</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Pure random function (mapping), although secure, is impractical due to space limitations.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Use a PRF (pseudo random function) instead.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Secret k indexes into a family of pseudo random functions and uses that for hashing.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Recall function here is just that, a function. It does not need to be 1-1 or invertible.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">PRF can be asserted as secure by asking if an attacker can win the "PRF Game”</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Integrity solved via a MAC (Message Authentication Code). e.g. HMAC-SHA256</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A MAC is a function that takes a key and provides the hash using a “hash function” (which is fixed)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">MAC is ~ PRF, although slightly different.</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Message Confidentiality (Keep message contents hidden from eavesdropper)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Horrible Ciphers:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Caesar Cipher - Uses a hidden secret k and shifts all values in the plaintext k places. Decryption works by reversing this.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Can be broken by trivial frequency analysis.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Vigenere Cipher - Uses a hidden secret k (which is a word, not a single value now). Shifts each letter in the plaintext by the corresponding letter in k. If |k| &lt; |m|, essentially concatenate k to itself and continue.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Kasiski Method:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Can be broken by looking for repeating strings and getting the distance.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Distance is likely a multiple of the key length.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Once we know the key length n we can break the cipher text into n slices  and solve each as a Caesar Cipher</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If |k| &gt;= |m|, reduces to OTP (One Time Pad)</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Semi-Working Ciphers:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">One-time Pad (OTP)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Generate a shared secret k of random bits, s.t. |k| = |m|.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Encrypt: c = m xor k</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Decrypt m’ = c xor k</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Provably secure because we are essentially generating a random string which can contain no useful information to an attacker. Any string could be the result of this cipher text given some key k’.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Impractical because it truly can only be used once.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">(a xor k) xor (b xor k) = (a xor b).</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Then be sliding common strings that we expect to be in either a or b and xor with our result, we will get the output of the other value.</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Stream Cipher</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Given a shared secret k, have Alice and Bob seed a PRG with k.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Encrypt: To encrypt a message m of length l, generate l bits from the PRG, and xor those bits with m.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Decrypt: To decrypt a message m of length l, generate l bits from the PRG, and xor those bits with m.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Potential Flaws:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Assuming Alice and Bob’s PRG is at the same state. If Alice encrypts using l bits from the PRG, Bob can only decrypt by generating EXACTLY the same l bits from his PRG. If two messages are encrypted simultaneously the whole system breaks down.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Can never reuse the key or PRG output bits.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. Salsa20, RC2 (Broken), RC4 (Broken)</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Block Cipher (Best option)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Encrypt message in fixed length blocks with a reusable key.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Use a PRP (Pseudorandom Permutation) instead of a PRF because we need to be able to invert the function.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. AES (Fixed length input and output)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Split k into ten sub keys. Perform a set of operations ten times, each time using a different sub key.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Operations:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Non-Linearize - Run each byte through a non-linear function</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Shift - Circular shift each row. ith row shifted by i</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Linear-mix - Treat each columns as a 4d vector. Multiply by a constant invertible matrix</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Key-Addition - xor each byte with corresponding byte of round sub key</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">AES only works on fixed length messages</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">To encrypt multiple blocks:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Don’t use:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Encrypted Codebook Mode - Encrypts each block independently. Can keep edge details.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Cipher-Block Chaining (CBC) Mode - c_i = E_k(m_i xor c_i-1). Can suffer from padding oracle attacks.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Can Use:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Counter Mode - Uses block cipher as a PRG. msg_id = random data, m_i = E_k(msg_id || ctr)</span></li></ul></ul></ul></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Authentication (Recipient can verify message was sent by some sender)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Sometimes called a “digital signature”</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">RSA is a good way to accomplish this.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Confidentially and Integrity simultaneously</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Encrypt, then MAC.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">AEAD (Authenticated Encrypted and Associated Data)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">c, tag := Seal(k, m, associated_data)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">m’ = Unseal(k, c, associated_data, tag)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">AES_GCM (“Galois Counter Mode”)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. ChaCha-Poly1305, Salsa20-Poly1305</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Need two shared keys (shouldn’t reuse keys across methods. crypto detail, not mentioned here). Can use PRG to generate two shared keys via one shared key</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If there exists a reverse channel, use separate keys!</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Cryptographic Doom Principle: If you are required to perform any cryptographic operation before verifying the MAC on a message, it will probably lead to issues.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Hash Functions:</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Arbitrary length inputs. Fixed length outputs.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Not random.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. SHA, SHA-256, etc.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Desirable properties:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Collision Resistant: Hard to find x, x’ s.t. H(x) = H(x’)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Second Preimage Resistant: Given fixed x, hard to find x’ s.t. H(x) = H(x’)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Preimage Resistant: Given y, hard to find x’ s.t. H(x’) = y</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Broken Hash Functions: MD5, SHA1</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Usually vulnerable to length extension attacks.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Length Extension Attacks:</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Performed on hash functions.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Given z = H(m) for some m, find H(m || padding || v) for chosen v.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">This is possible on algorithms using the Merkle-Damgard Construction, which use intermittent states.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Therefore, at some point during the calculation of H(m || padding || v), it will use H(m) as an initial state.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">So if we know H(m), we can compute H(m || padding || v) since the hash function is known to us.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Randomness:</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">True randomness may not really exist.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Use a PRG instead.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Given small seed, generate sequence of ~random bits.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Can be asserted as secure by asking if an attacker can win the “PRG Game” (Similar to the “PRF Game”).</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">On Linux</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">/dev/random gives “reliable” random bits, can block until these bits are available.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">/dev/urandom gives output of a PRF, doesn’t block, but is seeded from /dev/random (and so initially may not really be random).</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Padding Oracles:</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Find a way to distinguish between invalid MAC and invalid padding.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Can be enough to learn plaintext.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. Vaudenay padding oracle attack.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Defences:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Don’t use separate errors for MAC and padding (unrealistic)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Always check integrity</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Constant-time code</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Limit branching</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Key Exchange:</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Diffie-Hellman - Relies on discrete log problem</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Alice and Bob public choose modulus p and base g (primitive root modulo 23)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Alice chooses secret a and sends Bob g^a mod p</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Bob chooses secret b and sends Alice g^b mod p</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Alice computes k = (g^b mod p)^a</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Bob computes k = (g^a mod p)^b</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">MITM Possible. Use digital signatures to defend against.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Forward Secrecy</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Learning old key shouldn’t help adversary learn new key</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Compromising an old session should not compromise future sessions.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Compromising long-term key should not allow decryption of recorded cipher texts</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Public-Key Cryptography</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">RSA - Relies on factoring being hard.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Pick two large random primes p and q</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">N := pq mod N</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Pick e to be relatively prime to (p-1)(q-1)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Find d so that ed mod (p-1)(q-1) = 1</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Public Key: (e, N), Private Key: (d, N)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">E_e(x) = x^e mod N, D_d(x) = x^d mod N</span></li></ul></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Secure Channel:</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Establish shared secret via Diffie-Hellman</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Verify RSA Signatures on k.</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Modern Cryptography</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Elliptic Curve Cryptography</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Relies on elliptic curve discrete log problem</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Smaller key sizes can be used</span></li></ul></ul><div><br/></div><div><span style="font-size: 24px; font-family: 'Helvetica Neue';">Web Architecture</span></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Early Technologies: telnet, ftp, sftp, smtp, nfs</span></div><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">HTTP</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Four Phases:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Open Connection</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Client Request</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Server response</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Close connection </span></li></ul></ul><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Cookies</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Store state for identity</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Sent by server, stored by browser</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Same Origin Policy</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Two pages have the same origin if the protocol, port, and host are all the same.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Cross-origin embedding legal</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Cross-origin scripting illegal</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Attacks</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Cross Site Request Forgery</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Sites may rely (incorrectly!) on cookies for authentication.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">A user can log into a site so obtain a session cookie, navigate to another site, and that site might try performing request expecting the cookie to exist.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Defense Idea: Embed a random token into each action on the site and require that token to be sent with the request.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If you’re on the website, the website can handle adding the hidden value.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">An attacker can’t access this however, so CSRF won’t work.</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">SQL Injection</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If database inputs aren’t sanitized, an attacker may be able to mess with your database by exploiting </span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Defense:</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Sanitize</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Use Prepared Statements</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">XSS (Cross Site Scripting)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Webpages may treat data as code.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">This can be exploited to do malicious things</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">HTTPS</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">TLS</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Replaced SSL.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Provides encryption between client and server.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Client and Server themselves are NOT protected here. TLS provides protection against the network itself.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">TLS Handshake</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Client sends cipher suites it supports</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Server picks a cipher suite, sends its choice, CA certificate, and signed DH parameters.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Client then sends its DH parameters to server and asks server to switch to encrypted communication based on the agreed upon cipher spec.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Server sends a response if it agrees.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Encrypted communication ensues.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Attacks</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">RC4-related Attacks</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">RC4 stream cipher can possess biases that can be utilized to leak cookies and passwords.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">CBC-related Attacks</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. BEAST and PODDLE</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">exploit weaknesses in TLS’s use of CBC to leak data.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Compression-related Attacks</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">TLS and HTTP use compression, but TLS broadcasts length of plaintext.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Using both TLS and HTTP can leak data.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Export-related Attacks</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. Freak, Logjam, DROWN</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Exploit weaknesses in 1990s-era “export-grade” cryptography. </span></li></ul></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Certificates</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Say Bob has a web server (bob.com). He wants to obtain a certificate.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Generates public/private key pair.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Sends public key to a CA (Certificate Authority).</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">CA verifies public key (not via crypto).</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">CA signs a certificate with CA’s private key noting Bob’s public key and sends to </span><a style="font-size: 12px; font-family: 'Helvetica Neue';" href="http://bob.com">bob.com</a></li><li><a style="font-size: 12px; font-family: 'Helvetica Neue';" href="http://bob.com">bob.com</a><span style="font-size: 12px; font-family: 'Helvetica Neue';"> keeps certificate.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When Alice wants to load bob.com, she first checks the certificate against the CA’s public key.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Mixed Content</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Don’t allow active HTTP content on an HTTPS page. Passive is okay.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Strict Transport Security (HSTS)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">HTTP header indicating always use HTTPs</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Prevents downgrade attacks.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Protects future sessions, but not first session.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Preload Lists</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">List of sites that are HTTPS only.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Attacks</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Picture in Picture Attack</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Spoof user interface to stick user interface into thinking they’ve loaded a secure site.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Semantic Attacks</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Use “tricky” characters. e.g. </span><a style="font-size: 12px; font-family: 'Helvetica Neue';" href="http://microsoft.com">microsoft.com</a><span style="font-size: 12px; font-family: 'Helvetica Neue';"> vs </span><a style="font-size: 12px; font-family: 'Helvetica Neue';" href="http://micr0soft.com">micr0soft.com</a></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Invalid Certs</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Expired, != URL, unknown CA (self-signed)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Users can and will skip through warnings.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ssl_strip attack</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">MITM Attack</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Victim  &lt;— HTTP —&gt;  Attacker  &lt;— HTTPS —&gt; Some HTTPS Site</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Mixed Content Attack</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Page loads over HTTPs but loads content over HTTP</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Active attacker can tamper with the HTTP content.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">FREAK Attack</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">MITM where it downgrades available cipher suites to include only export-grade RSA</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Export-grade RSA uses only 512-bit keys, which can be factored quickly.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Worked on ~9% of HTTPS sites</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Browser bug</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Logjam Attack</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Similar to FREAK, but against export-grade Diffie-Hellman instead of RSA.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Protocol flaw.</span></li></ul></ul></ul><div><br/></div><div><span style="font-size: 24px; font-family: 'Helvetica Neue';">Networking</span></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Internet Layers</span></div><ol start="1"><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Application - Application Packet Data</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">DNS, SSH, FTP, SMTP, NTP, HTTP</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Transport - Prepends TCP Header to packet</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">UDP, TCP</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Network - Prepends IP Header to packet</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IP</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Link - Prepends Frame Header and appends Frame Trailer to packet.</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">WiFi, LTE, Ethernet</span></li></ul></ol><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">DNS (Domain Name System)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Distributed system to map domain names to ip addresses (IPv4 32 bits, IPv6 128 bits)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Implemented in “name servers”</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Application-layer protocol</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">TCP (Transmission Control Protocol)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Connection-Oriented</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Setup needed between client and server</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Reliable-Transport</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Will keep sending requests until it gets a response</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Flow-Control</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Sender won’t overwhelm receiver</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Congestion-Control</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Throttles sender when network overloaded</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Doesn’t supply</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Timing</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Minimum Throughput</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Security</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When sending</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Send Side: Breaks application data into segments, passes to network layer</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Receive Side: Reassembles data into messages, passes to application layer</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Handshake</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Client —&gt; SYN Packet —&gt; Server</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Server —&gt; SYNACK Packet —&gt; Client</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Client —&gt; ACK Packet —&gt; Server</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Connection Established. </span></li></ul></ul><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">UDP (User Datagram Protocol)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Message-oriented</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Unreliable-Transport</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Doesn’t supply</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Connection Setup</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Reliability</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Flow Control</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Congestion control</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">timing</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">throughput</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">security</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Internet Protocol (IP)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Connectionless</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Individual packets completely independent from other packets</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Unreliable</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">No guarantee packets get sent</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">May be lost, corrupted, reordered, duplicated, etc.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IP Addresses</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Divided into two parts</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Network: Routes packets</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Host: Individual host</span></li></ul></ul></ul><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Network Address Translation (NAT)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IPv4 only contains ~4 billion addresses</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Workaround is to use NAT</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Routers give “private ip addresses” for local use only.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Router must remember mappings, because it only sends out addresses from the actual IP of the router.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Link Layer</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Converts datagram from virtual to “physical” world.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Connectionless</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Unreliable</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. Ethernet</span></li></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Address Resolution Protocol (ARP)</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Mechanism to find MAC addresses of other machines</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Broadcast ARP query (Who has IP ___, respond to A)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Any node that recognizes the IP responses to A.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Used in ARP Spoofing</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Simply respond loud enough that you recognize some IP, but just respond a wrong MAC.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Network Attacks</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Link Layer</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ARP Spoofing (Mentioned earlier)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Only works on local network</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Network Layer</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">IP Spoofing</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">BGP Route Hijacking</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">DNS Spoofing (DNS Cache Poisoning)</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Transport Layer</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">TCP Injection</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">DoS via TCP RST</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">UDP Amplification</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Application</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">DNS maps</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">BGP maps</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Exploits</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Virus - Exploit that attaches to a file or program</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Worm - Self-Propagating exploit</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Trojan - Exploit designed as something interesting</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Botnets - Compromised distributed systems</span></li></ul><div><br/></div><div><span style="font-size: 24px; font-family: 'Helvetica Neue';">Application Security</span></div><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Password Security</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Weak passwords can suffer from brute force attacks</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Storing Passwords in Plaintext</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Easy to develop</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Database leak reveals passwords to attackers. Site Ops can find passwords</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Storing Encrypted Passwords</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Leaked database probably will also leak key. Site Ops can still find passwords</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Store Hash of password</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Identical Passwords have identical hashes.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Rainbow tables can be used to break these</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Store salted hashes</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Randomly generate a salt for each user’s password</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Store Hash(salt || password)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Don’t use SHA or MD5! This is not the same as integrity</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">bcrypt, scrypt, argon2 are better</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">U2F</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Open standard developed by Google and Yahoo</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Browser gets username and password, verifies password.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If passes, generate challenge, send to user’s device.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Verify response</span></li></ul></ul><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Control-Hijacking</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Buffer Overflow Attacks</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If a program is vulnerable to allow writing over the expected buffer, we can write over the stack and replace the return address.</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Stack Shellcode</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Load your own application into memory</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Buffer Overflow but jump to your application</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Return to libc</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Overwrite data that is sent to existing library command (execv)</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Buffer Over-read</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Don’t write over the buffer, but instead read more than the buffer is suppose to contain which can leak information</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">e.g. Heartbleed vulnerability</span></li></ul></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ROP-Chains (Return Oriented Programming)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Return to libc without function calls</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Integer Overflow</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">When integers overflow, they wrap around (modulus)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">This can cause exploits if the length supplied is very large (but doesn’t overflow)</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">You can generate a small buffer via malloc (size * sizeof(type)) which can overflow and give you a small buffer</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">You then write a very large amount of data.</span></li></ul></ul><div><br/></div><div><span style="font-size: 12px; font-family: 'Helvetica Neue';">Control-Hijacking Defenses</span></div><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Data Execution Prevention (DEP)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Mark data pages as either R/W, executable,</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Requires hardware support</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Attacker cannot return to stack</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Stack Canaries</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">On function call, add a secret value “canary” right above the return address.</span></li><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">If we read the canary, throw error</span></li></ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">ASLR (Address Space Layout Randomization)</span></li><ul><li><span style="font-size: 12px; font-family: 'Helvetica Neue';">Makes it hard to predict references.</span></li></ul></ul><div><br/></div></body></html>